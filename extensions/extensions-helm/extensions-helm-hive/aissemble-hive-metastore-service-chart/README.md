# aiSSEMBLE Hive Metastore Service Helm Chart
Baseline Helm chart for packaging and deploying Hive Metastore Services. Chart is built and managed during the normal Maven build lifecycle and placed in the **target/helm/repo** directory. See https://github.com/kokuwaio/helm-maven-plugin for more details. 

# Basic usage with Helm CLI
To use the module, perform [extension-helm setup](../README.md#leveraging-extensions-helm) and override the chart version with the desired aiSSEMBLE version. For example:
```bash
helm install hive-metastore-service ghcr.io/boozallen/aissemble-hive-metastore-service-chart --version <AISSEMBLE-VERSION>
```
**Note**: *the version should match the aiSSEMBLE project version.*

# Properties
| Property                                              | Description                                        | Required Override | Default                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|-------------------------------------------------------|----------------------------------------------------|-------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| app.name                                              | Sets label for app.kubernetes.io/name              | No                | Chart.Name (aissemble-hive-metastore-service)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| app.version                                           | Sets label for app.kubernetes.io/version           | No                | Chart.AppVersion (aiSSEMBLE project version)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| replicaCount                                          | Sets desired number of replicas (instances)        | No                | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| hostname                                              | The hostname for the application                   | No                | hive-metastore-service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| image.name                                            | The image name                                     | Yes               | boozallen/aissemble-hive-service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| image.imagePullPolicy                                 | The image pull policy                              | No                | IfNotPresent                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| image.dockerRepo                                      | The image docker repository                        | No                | NB: OSS: update with aissemble docker repository                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| image.tag                                             | The image tag                                      | No                | Chart.AppVersion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| deployment.ports                                      | The deployment ports                               | No                | &emsp; - name: "thrift" <br/>&emsp;&emsp;containerPort: 9083                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| deployment.env                                        | The environment variables for the pod              | No                | &emsp; - name: HADOOP_HOME <br/>&emsp;&emsp;value: /opt/hadoop-3.3.1 <br/>&emsp; - name: HADOOP_CLASSPATH <br/>&emsp;&emsp;value: $HADOOP_CLASSPATH:/opt/hadoop-3.3.1/share/hadoop/tools/lib/*.jar <br/>&emsp; - name: JAVA_HOME <br/>&emsp;&emsp;value: /usr/local/openjdk-11 <br/>&emsp; - name: HIVE_HOME <br/>&emsp;&emsp;value: /opt/apache-hive-metastore-3.0.0-bin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| deployment.restartPolicy                              | The deployment restart policy                      | No                | Always                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| deployment.volumeMounts                               | The deployment volume mounts                       | No                | &emsp; - name: metastore-service-config <br/>&emsp;&emsp;mountPath: /opt/apache-hive-metastore-3.0.0-bin/conf/metastore-site.xml <br/>&emsp;&emsp;subPath: metastore-site.xml                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| deployment.volumes                                    | The deployment volumes                             | No                | &emsp; - name: metastore-service-config <br/>&emsp;&emsp;configMap: <br/>&emsp;&emsp;&emsp;name: metastore-service-config <br/>&emsp;&emsp;&emsp;items: <br/>&emsp;&emsp;&emsp;&emsp; - key: metastore-site.xml <br/>&emsp;&emsp;&emsp;&emsp;&emsp;path: metastore-site.xml                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| service.spec.ports                                    | The service spec ports                             | No                | &emsp; - name: "thrift" <br/>&emsp;&emsp;port: 9083 <br/>&emsp;&emsp;targetPort: 9083                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| configMap.metastoreServiceConfig.properties           | Default configuration for the metastore service    | No                | &emsp; - name: metastore.thrift.uris <br/>&emsp;&emsp;value: thrift://0.0.0.0:9083 <br/>&emsp;&emsp;description: Thrift URI for the remote metastore. Used by metastore client to connect to remote metastore. <br/>&emsp; - name: metastore.task.threads.always <br/>&emsp;&emsp;value: org.apache.hadoop.hive.metastore.events.EventCleanerTask,org.apache.hadoop.hive.metastore.MaterializationsCacheCleanerTask <br/>&emsp; - name: metastore.expression.proxy <br/>&emsp;&emsp;value: org.apache.hadoop.hive.metastore.DefaultPartitionExpressionProxy <br/>&emsp; - name: javax.jdo.option.ConnectionDriverName <br/>&emsp;&emsp;value: com.mysql.cj.jdbc.Driver <br/>&emsp; - name: javax.jdo.option.ConnectionURL <br/>&emsp;&emsp;value: jdbc:mysql://hive-metastore-db:3306/metastore?createDatabaseIfNotExist=true\&amp;allowPublicKeyRetrieval=true\&amp;useSSL=false <br/>&emsp;&emsp;description: JDBC connect string for a JDBC metastore <br/>&emsp; - name: javax.jdo.option.ConnectionUserName <br/>&emsp;&emsp;value: hive <br/>&emsp;&emsp;description: Username to use against metastore database <br/>&emsp; - name: javax.jdo.option.ConnectionPassword <br/>&emsp;&emsp;value: hive <br/>&emsp;&emsp;description: Password to use against metastore database <br/>&emsp; - name: metastore.warehouse.dir <br/>&emsp;&emsp;value: s3a://spark-infrastructure/warehouse |
| configMap.metastoreServiceConfig.additionalProperties | Optional configuration for the metastore service. Properties added here will be included in the configuration without overriding the default properties | No                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |

